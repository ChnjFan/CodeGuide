# 计算机网络

> 计算机网络的核心是网络协议，详细规定了计算机之间如何连接和组网。理解了网络协议，就理解了互联网的原理。

[TOC]

## 网络协议概念

计算机网络协议是实现计算机之间数据通信的规则和标准，其实现分为五层，通过定义互联网协议来实现具体的功能。

### 应用层

应用层用于规定应用程序的数据格式，不用关心数据如何传输，只需要专注于用户提供应用功能。

- [HTTP 详解](./Protocol/http.md)

### 传输层

传输层通过**端口**（port）建立主机**端到端**的通信链路，只要确定主机和端口即可实现应用层的通信。

- [Socket](./socket.md) - 主机+端口。
- [TCP 协议](./Protocol/tcp.md) - 可靠传输，流量控制、超时重传、拥塞控制等。
- [UDP 协议](./Protocol/udp.md) - 只负责发送数据包，不保证数据包能够发送到对端。实时性更高，传输效率高。

### 网络层

网络层主要负责**跨网络的数据包传输与路由**，连接不同类型网络之间的通信。主要功能包括：路由转发、分片和重组。

- [IP 协议](./Protocol/ip.md) -  网络层引入 IP 地址，通过子网掩码确定计算机所在子网，确定子网后根据 MAC 地址将数据包传送到子网的目标网卡。
  - IPv4：网络地址由 32 位组成。
  - IPV6：网络地址由 128 为组成。
- [ICMP 协议](./Protocol/icmp.md) - 传递网络控制信息和错误报告。
- [IGMP 协议](./Protocol/igmp.md) - 管理组播通信，主机通过 IGMP 通告路由器加入或离开某个组播组。
- [DHCP 协议](./Protocol/dhcp.md) - 动态主机配置协议，用于自动分配 IP 地址和网络配置。

#### 路由协议

路由表决定了数据报的转发路径，通过最长前缀匹配查找精确路由。

- **IGP**：内部网关协议，用于同一自治系统（AS）内部。
  - [RIP 协议](./Protocol/rip.md) - 路由信息协议，基于跳数的距离矢量协议，适用于小型网络。
  - [OSPF 协议](./Protocol/ospf.md) - 开放最短路径优先协议，基于链路状态的协议，适用于中大型网络，收敛速度快。
- **EGP**：外部网关协议，用于不同自治系统之间。
  - [BGP 协议](./Protocol/bgp.md) - 边界网关协议，互联网核心路由协议，基于路径属性选择最佳路由，连接不同运营商网络。

### 数据链路层

链路层为网络层提供数据传输服务，负责在以太网、WiFi 等底层网络发送原始数据包。

- [ARP 协议](./Protocol/arp.md) - 负责 IP 地址与 MAC 地址之间的映射。

- 以太网协议 - 以太网规定一组电信号构成一个数据包——帧（Frame），每一帧由标头和数据组成。
  - 标头：MAC 地址信息，数据类型，固定 18 字节。
  - 数据：IP 报文，最长 1500 字节，最短 46 字节。

##### MAC 地址

网卡中标记的地址，数据包中发送地址和接收地址叫做 MAC 地址，24 位组成。

网卡出厂时厂商标记，前 12 位是厂商编号，后 12 位是网卡流水号。

##### 广播

以太网将数据包向本网络内所有计算机发送，然后由计算机判断是否为接收方。

接收到数据的计算机获取到数据包的目的 MAC 地址与自身地址相比，如果不同就丢弃数据包。

ARP 表查找不到后才会使用广播发送数据。

#### 物理层

通过光缆、电缆、双绞线、无线电波等介质将计算机连接起来。

## 网络工具

- [tcpdump](./Tools/tcpdump.md) - 命令行抓包工具。
- [ifconfig](./Tools/ifconfig.md) - 查看网络接口信息。
- [netstat](./Tools/netstat.md) - 查看网络状态和连接信息。
